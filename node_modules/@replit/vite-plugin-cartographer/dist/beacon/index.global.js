"use strict";(()=>{var Y="0.0.8";function Ce(e,t){return e[13]=1,e[14]=t>>8,e[15]=t&255,e[16]=t>>8,e[17]=t&255,e}var ne=112,re=72,oe=89,ie=115,W;function Ae(){let e=new Int32Array(256);for(let t=0;t<256;t++){let n=t;for(let r=0;r<8;r++)n=n&1?3988292384^n>>>1:n>>>1;e[t]=n}return e}function Le(e){let t=-1;W||(W=Ae());for(let n=0;n<e.length;n++)t=W[(t^e[n])&255]^t>>>8;return t^-1}function Ne(e){let t=e.length-1;for(let n=t;n>=4;n--)if(e[n-4]===9&&e[n-3]===ne&&e[n-2]===re&&e[n-1]===oe&&e[n]===ie)return n-3;return 0}function Ie(e,t,n=!1){let r=new Uint8Array(13);t*=39.3701,r[0]=ne,r[1]=re,r[2]=oe,r[3]=ie,r[4]=t>>>24,r[5]=t>>>16,r[6]=t>>>8,r[7]=t&255,r[8]=r[4],r[9]=r[5],r[10]=r[6],r[11]=r[7],r[12]=1;let s=Le(r),i=new Uint8Array(4);if(i[0]=s>>>24,i[1]=s>>>16,i[2]=s>>>8,i[3]=s&255,n){let a=Ne(e);return e.set(r,a),e.set(i,a+13),e}else{let a=new Uint8Array(4);a[0]=0,a[1]=0,a[2]=0,a[3]=9;let o=new Uint8Array(54);return o.set(e,0),o.set(a,33),o.set(r,37),o.set(i,50),o}}var De="AAlwSFlz",xe="AAAJcEhZ",_e="AAAACXBI";function Me(e){let t=e.indexOf(De);return t===-1&&(t=e.indexOf(xe)),t===-1&&(t=e.indexOf(_e)),t}var se="[modern-screenshot]",C=typeof window<"u",He=C&&"Worker"in window,Re=C&&"atob"in window,Fe=C&&"btoa"in window,j=C?window.navigator?.userAgent:"",ae=j.includes("Chrome"),P=j.includes("AppleWebKit")&&!ae,V=j.includes("Firefox"),Pe=e=>e&&"__CONTEXT__"in e,Oe=e=>e.constructor.name==="CSSFontFaceRule",ke=e=>e.constructor.name==="CSSImportRule",v=e=>e.nodeType===1,_=e=>typeof e.className=="object",le=e=>e.tagName==="image",Ue=e=>e.tagName==="use",I=e=>v(e)&&typeof e.style<"u"&&!_(e),Be=e=>e.nodeType===8,$e=e=>e.nodeType===3,N=e=>e.tagName==="IMG",O=e=>e.tagName==="VIDEO",We=e=>e.tagName==="CANVAS",Ge=e=>e.tagName==="TEXTAREA",je=e=>e.tagName==="INPUT",Ve=e=>e.tagName==="STYLE",ze=e=>e.tagName==="SCRIPT",qe=e=>e.tagName==="SELECT",Xe=e=>e.tagName==="SLOT",Ye=e=>e.tagName==="IFRAME",Je=(...e)=>console.warn(se,...e);function Ke(e){let t=e?.createElement?.("canvas");return t&&(t.height=t.width=1),!!t&&"toDataURL"in t&&!!t.toDataURL("image/webp").includes("image/webp")}var G=e=>e.startsWith("data:");function ce(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(C&&e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i)||!C)return e;let n=k().implementation.createHTMLDocument(),r=n.createElement("base"),s=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(s),t&&(r.href=t),s.href=e,s.href}function k(e){return(e&&v(e)?e?.ownerDocument:e)??window.document}var U="http://www.w3.org/2000/svg";function Qe(e,t,n){let r=k(n).createElementNS(U,"svg");return r.setAttributeNS(null,"width",e.toString()),r.setAttributeNS(null,"height",t.toString()),r.setAttributeNS(null,"viewBox",`0 0 ${e} ${t}`),r}function Ze(e,t){let n=new XMLSerializer().serializeToString(e);return t&&(n=n.replace(/[\u0000-\u0008\v\f\u000E-\u001F\uD800-\uDFFF\uFFFE\uFFFF]/gu,"")),`data:image/svg+xml;charset=utf-8,${encodeURIComponent(n)}`}function et(e,t){return new Promise((n,r)=>{let s=new FileReader;s.onload=()=>n(s.result),s.onerror=()=>r(s.error),s.onabort=()=>r(new Error(`Failed read blob to ${t}`)),t==="dataUrl"?s.readAsDataURL(e):t==="arrayBuffer"&&s.readAsArrayBuffer(e)})}var tt=e=>et(e,"dataUrl");function L(e,t){let n=k(t).createElement("img");return n.decoding="sync",n.loading="eager",n.src=e,n}function D(e,t){return new Promise(n=>{let{timeout:r,ownerDocument:s,onError:i,onWarn:a}=t??{},o=typeof e=="string"?L(e,k(s)):e,c=null,h=null;function l(){n(o),c&&clearTimeout(c),h?.()}if(r&&(c=setTimeout(l,r)),O(o)){let u=o.currentSrc||o.src;if(!u)return o.poster?D(o.poster,t).then(n):l();if(o.readyState>=2)return l();let d=l,m=g=>{a?.("Failed video load",u,g),i?.(g),l()};h=()=>{o.removeEventListener("loadeddata",d),o.removeEventListener("error",m)},o.addEventListener("loadeddata",d,{once:!0}),o.addEventListener("error",m,{once:!0})}else{let u=le(o)?o.href.baseVal:o.currentSrc||o.src;if(!u)return l();let d=async()=>{if(N(o)&&"decode"in o)try{await o.decode()}catch(g){a?.("Failed to decode image, trying to render anyway",o.dataset.originalSrc||u,g)}l()},m=g=>{a?.("Failed image load",o.dataset.originalSrc||u,g),l()};if(N(o)&&o.complete)return d();h=()=>{o.removeEventListener("load",d),o.removeEventListener("error",m)},o.addEventListener("load",d,{once:!0}),o.addEventListener("error",m,{once:!0})}})}async function nt(e,t){I(e)&&(N(e)||O(e)?await D(e,t):await Promise.all(["img","video"].flatMap(n=>Array.from(e.querySelectorAll(n)).map(r=>D(r,t)))))}var ue=function(){let t=0,n=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(t+=1,`u${n()}${t}`)}();function de(e){return e?.split(",").map(t=>t.trim().replace(/"|'/g,"").toLowerCase()).filter(Boolean)}var J=0;function rt(e){let t=`${se}[#${J}]`;return J++,{time:n=>e&&console.time(`${t} ${n}`),timeEnd:n=>e&&console.timeEnd(`${t} ${n}`),warn:(...n)=>e&&Je(...n)}}function ot(e){return{cache:e?"no-cache":"force-cache"}}async function B(e,t){return Pe(e)?e:it(e,{...t,autoDestruct:!0})}async function it(e,t){let{scale:n=1,workerUrl:r,workerNumber:s=1}=t||{},i=!!t?.debug,a=t?.features??!0,o=e.ownerDocument??(C?window.document:void 0),c=e.ownerDocument?.defaultView??(C?window:void 0),h=new Map,l={width:0,height:0,quality:1,type:"image/png",scale:n,backgroundColor:null,style:null,filter:null,maximumCanvasSize:0,timeout:3e4,progress:null,debug:i,fetch:{requestInit:ot(t?.fetch?.bypassingCache),placeholderImage:"data:image/png;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",bypassingCache:!1,...t?.fetch},fetchFn:null,font:{},drawImageInterval:100,workerUrl:null,workerNumber:s,onCloneNode:null,onEmbedNode:null,onCreateForeignObjectSvg:null,includeStyleProperties:null,autoDestruct:!1,...t,__CONTEXT__:!0,log:rt(i),node:e,ownerDocument:o,ownerWindow:c,dpi:n===1?null:96*n,svgStyleElement:he(o),svgDefsElement:o?.createElementNS(U,"defs"),svgStyles:new Map,defaultComputedStyles:new Map,workers:[...Array.from({length:He&&r&&s?s:0})].map(()=>{try{let m=new Worker(r);return m.onmessage=async g=>{let{url:f,result:p}=g.data;p?h.get(f)?.resolve?.(p):h.get(f)?.reject?.(new Error(`Error receiving message from worker: ${f}`))},m.onmessageerror=g=>{let{url:f}=g.data;h.get(f)?.reject?.(new Error(`Error receiving message from worker: ${f}`))},m}catch(m){return l.log.warn("Failed to new Worker",m),null}}).filter(Boolean),fontFamilies:new Map,fontCssTexts:new Map,acceptOfImage:`${[Ke(o)&&"image/webp","image/svg+xml","image/*","*/*"].filter(Boolean).join(",")};q=0.8`,requests:h,drawImageCount:0,tasks:[],features:a,isEnable:m=>m==="restoreScrollPosition"?typeof a=="boolean"?!1:a[m]??!1:typeof a=="boolean"?a:a[m]??!0};l.log.time("wait until load"),await nt(e,{timeout:l.timeout,onWarn:l.log.warn}),l.log.timeEnd("wait until load");let{width:u,height:d}=st(e,l);return l.width=u,l.height=d,l}function he(e){if(!e)return;let t=e.createElement("style"),n=t.ownerDocument.createTextNode(`
.______background-clip--text {
  background-clip: text;
  -webkit-background-clip: text;
}
`);return t.appendChild(n),t}function st(e,t){let{width:n,height:r}=t;if(v(e)&&(!n||!r)){let s=e.getBoundingClientRect();n=n||s.width||Number(e.getAttribute("width"))||0,r=r||s.height||Number(e.getAttribute("height"))||0}return{width:n,height:r}}async function at(e,t){let{log:n,timeout:r,drawImageCount:s,drawImageInterval:i}=t;n.time("image to canvas");let a=await D(e,{timeout:r,onWarn:t.log.warn}),{canvas:o,context2d:c}=lt(e.ownerDocument,t),h=()=>{try{c?.drawImage(a,0,0,o.width,o.height)}catch(l){t.log.warn("Failed to drawImage",l)}};if(h(),t.isEnable("fixSvgXmlDecode"))for(let l=0;l<s;l++)await new Promise(u=>{setTimeout(()=>{h(),u()},l+i)});return t.drawImageCount=0,n.timeEnd("image to canvas"),o}function lt(e,t){let{width:n,height:r,scale:s,backgroundColor:i,maximumCanvasSize:a}=t,o=e.createElement("canvas");o.width=Math.floor(n*s),o.height=Math.floor(r*s),o.style.width=`${n}px`,o.style.height=`${r}px`,a&&(o.width>a||o.height>a)&&(o.width>a&&o.height>a?o.width>o.height?(o.height*=a/o.width,o.width=a):(o.width*=a/o.height,o.height=a):o.width>a?(o.height*=a/o.width,o.width=a):(o.width*=a/o.height,o.height=a));let c=o.getContext("2d");return c&&i&&(c.fillStyle=i,c.fillRect(0,0,o.width,o.height)),{canvas:o,context2d:c}}function ge(e,t){if(e.ownerDocument)try{let i=e.toDataURL();if(i!=="data:,")return L(i,e.ownerDocument)}catch(i){t.log.warn("Failed to clone canvas",i)}let n=e.cloneNode(!1),r=e.getContext("2d"),s=n.getContext("2d");try{return r&&s&&s.putImageData(r.getImageData(0,0,e.width,e.height),0,0),n}catch(i){t.log.warn("Failed to clone canvas",i)}return n}function ct(e,t){try{if(e?.contentDocument?.body)return z(e.contentDocument.body,t)}catch(n){t.log.warn("Failed to clone iframe",n)}return e.cloneNode(!1)}function ut(e){let t=e.cloneNode(!1);return e.currentSrc&&e.currentSrc!==e.src&&(t.src=e.currentSrc,t.srcset=""),t.loading==="lazy"&&(t.loading="eager"),t}async function dt(e,t){if(e.ownerDocument&&!e.currentSrc&&e.poster)return L(e.poster,e.ownerDocument);let n=e.cloneNode(!1);n.crossOrigin="anonymous",e.currentSrc&&e.currentSrc!==e.src&&(n.src=e.currentSrc);let r=n.ownerDocument;if(r){let s=!0;if(await D(n,{onError:()=>s=!1,onWarn:t.log.warn}),!s)return e.poster?L(e.poster,e.ownerDocument):n;n.currentTime=e.currentTime,await new Promise(a=>{n.addEventListener("seeked",a,{once:!0})});let i=r.createElement("canvas");i.width=e.offsetWidth,i.height=e.offsetHeight;try{let a=i.getContext("2d");a&&a.drawImage(n,0,0,i.width,i.height)}catch(a){return t.log.warn("Failed to clone video",a),e.poster?L(e.poster,e.ownerDocument):n}return ge(i,t)}return n}function ht(e,t){return We(e)?ge(e,t):Ye(e)?ct(e,t):N(e)?ut(e):O(e)?dt(e,t):e.cloneNode(!1)}function gt(e){let t=e.sandbox;if(!t){let{ownerDocument:n}=e;try{n&&(t=n.createElement("iframe"),t.id=`__SANDBOX__-${ue()}`,t.width="0",t.height="0",t.style.visibility="hidden",t.style.position="fixed",n.body.appendChild(t),t.contentWindow?.document.write('<!DOCTYPE html><meta charset="UTF-8"><title></title><body>'),e.sandbox=t)}catch(r){e.log.warn("Failed to getSandBox",r)}}return t}var ft=["width","height","-webkit-text-fill-color"],mt=["stroke","fill"];function fe(e,t,n){let{defaultComputedStyles:r}=n,s=e.nodeName.toLowerCase(),i=_(e)&&s!=="svg",a=i?mt.map(f=>[f,e.getAttribute(f)]).filter(([,f])=>f!==null):[],o=[i&&"svg",s,a.map((f,p)=>`${f}=${p}`).join(","),t].filter(Boolean).join(":");if(r.has(o))return r.get(o);let h=gt(n)?.contentWindow;if(!h)return new Map;let l=h?.document,u,d;i?(u=l.createElementNS(U,"svg"),d=u.ownerDocument.createElementNS(u.namespaceURI,s),a.forEach(([f,p])=>{d.setAttributeNS(null,f,p)}),u.appendChild(d)):u=d=l.createElement(s),d.textContent=" ",l.body.appendChild(u);let m=h.getComputedStyle(d,t),g=new Map;for(let f=m.length,p=0;p<f;p++){let w=m.item(p);ft.includes(w)||g.set(w,m.getPropertyValue(w))}return l.body.removeChild(u),r.set(o,g),g}function me(e,t,n){let r=new Map,s=[],i=new Map;if(n)for(let o of n)a(o);else for(let o=e.length,c=0;c<o;c++){let h=e.item(c);a(h)}for(let o=s.length,c=0;c<o;c++)i.get(s[c])?.forEach((h,l)=>r.set(l,h));function a(o){let c=e.getPropertyValue(o),h=e.getPropertyPriority(o),l=o.lastIndexOf("-"),u=l>-1?o.substring(0,l):void 0;if(u){let d=i.get(u);d||(d=new Map,i.set(u,d)),d.set(o,[c,h])}t.get(o)===c&&!h||(u?s.push(u):r.set(o,[c,h]))}return r}function pt(e,t,n,r){let{ownerWindow:s,includeStyleProperties:i,currentParentNodeStyle:a}=r,o=t.style,c=s.getComputedStyle(e),h=fe(e,null,r);a?.forEach((u,d)=>{h.delete(d)});let l=me(c,h,i);l.delete("transition-property"),l.delete("all"),l.delete("d"),l.delete("content"),n&&(l.delete("margin-top"),l.delete("margin-right"),l.delete("margin-bottom"),l.delete("margin-left"),l.delete("margin-block-start"),l.delete("margin-block-end"),l.delete("margin-inline-start"),l.delete("margin-inline-end"),l.set("box-sizing",["border-box",""])),l.get("background-clip")?.[0]==="text"&&t.classList.add("______background-clip--text"),ae&&(l.has("font-kerning")||l.set("font-kerning",["normal",""]),(l.get("overflow-x")?.[0]==="hidden"||l.get("overflow-y")?.[0]==="hidden")&&l.get("text-overflow")?.[0]==="ellipsis"&&e.scrollWidth===e.clientWidth&&l.set("text-overflow",["clip",""]));for(let u=o.length,d=0;d<u;d++)o.removeProperty(o.item(d));return l.forEach(([u,d],m)=>{o.setProperty(m,u,d)}),l}function wt(e,t){(Ge(e)||je(e)||qe(e))&&t.setAttribute("value",e.value)}var Et=[":before",":after"],bt=[":-webkit-scrollbar",":-webkit-scrollbar-button",":-webkit-scrollbar-thumb",":-webkit-scrollbar-track",":-webkit-scrollbar-track-piece",":-webkit-scrollbar-corner",":-webkit-resizer"];function yt(e,t,n,r,s){let{ownerWindow:i,svgStyleElement:a,svgStyles:o,currentNodeStyle:c}=r;if(!a||!i)return;function h(l){let u=i.getComputedStyle(e,l),d=u.getPropertyValue("content");if(!d||d==="none")return;s?.(d),d=d.replace(/(')|(")|(counter\(.+\))/g,"");let m=[ue()],g=fe(e,l,r);c?.forEach((E,y)=>{g.delete(y)});let f=me(u,g,r.includeStyleProperties);f.delete("content"),f.delete("-webkit-locale"),f.get("background-clip")?.[0]==="text"&&t.classList.add("______background-clip--text");let p=[`content: '${d}';`];if(f.forEach(([E,y],T)=>{p.push(`${T}: ${E}${y?" !important":""};`)}),p.length===1)return;try{t.className=[t.className,...m].join(" ")}catch(E){r.log.warn("Failed to copyPseudoClass",E);return}let w=p.join(`
  `),b=o.get(w);b||(b=[],o.set(w,b)),b.push(`.${m[0]}:${l}`)}Et.forEach(h),n&&bt.forEach(h)}var K=new Set(["symbol"]);async function Q(e,t,n,r,s){if(v(n)&&(Ve(n)||ze(n))||r.filter&&!r.filter(n))return;K.has(t.nodeName)||K.has(n.nodeName)?r.currentParentNodeStyle=void 0:r.currentParentNodeStyle=r.currentNodeStyle;let i=await z(n,r,!1,s);r.isEnable("restoreScrollPosition")&&vt(e,i),t.appendChild(i)}async function Z(e,t,n,r){let s=(v(e)?e.shadowRoot?.firstChild:void 0)??e.firstChild;for(let i=s;i;i=i.nextSibling)if(!Be(i))if(v(i)&&Xe(i)&&typeof i.assignedNodes=="function"){let a=i.assignedNodes();for(let o=0;o<a.length;o++)await Q(e,t,a[o],n,r)}else await Q(e,t,i,n,r)}function vt(e,t){if(!I(e)||!I(t))return;let{scrollTop:n,scrollLeft:r}=e;if(!n&&!r)return;let{transform:s}=t.style,i=new DOMMatrix(s),{a,b:o,c,d:h}=i;i.a=1,i.b=0,i.c=0,i.d=1,i.translateSelf(-r,-n),i.a=a,i.b=o,i.c=c,i.d=h,t.style.transform=i.toString()}function St(e,t){let{backgroundColor:n,width:r,height:s,style:i}=t,a=e.style;if(n&&a.setProperty("background-color",n,"important"),r&&a.setProperty("width",`${r}px`,"important"),s&&a.setProperty("height",`${s}px`,"important"),i)for(let o in i)a[o]=i[o]}var Tt=/^[\w-:]+$/;async function z(e,t,n=!1,r){let{ownerDocument:s,ownerWindow:i,fontFamilies:a}=t;if(s&&$e(e))return r&&/\S/.test(e.data)&&r(e.data),s.createTextNode(e.data);if(s&&i&&v(e)&&(I(e)||_(e))){let c=await ht(e,t);if(t.isEnable("removeAbnormalAttributes")){let g=c.getAttributeNames();for(let f=g.length,p=0;p<f;p++){let w=g[p];Tt.test(w)||c.removeAttribute(w)}}let h=t.currentNodeStyle=pt(e,c,n,t);n&&St(c,t);let l=!1;if(t.isEnable("copyScrollbar")){let g=[h.get("overflow-x")?.[0],h.get("overflow-y")?.[0]];l=g.includes("scroll")||(g.includes("auto")||g.includes("overlay"))&&(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)}let u=h.get("text-transform")?.[0],d=de(h.get("font-family")?.[0]),m=d?g=>{u==="uppercase"?g=g.toUpperCase():u==="lowercase"?g=g.toLowerCase():u==="capitalize"&&(g=g[0].toUpperCase()+g.substring(1)),d.forEach(f=>{let p=a.get(f);p||a.set(f,p=new Set),g.split("").forEach(w=>p.add(w))})}:void 0;return yt(e,c,l,t,m),wt(e,c),O(e)||await Z(e,c,t,m),c}let o=e.cloneNode(!1);return await Z(e,o,t),o}function Ct(e){if(e.ownerDocument=void 0,e.ownerWindow=void 0,e.svgStyleElement=void 0,e.svgDefsElement=void 0,e.svgStyles.clear(),e.defaultComputedStyles.clear(),e.sandbox){try{e.sandbox.remove()}catch(t){e.log.warn("Failed to destroyContext",t)}e.sandbox=void 0}e.workers=[],e.fontFamilies.clear(),e.fontCssTexts.clear(),e.requests.clear(),e.tasks=[]}function At(e){let{url:t,timeout:n,responseType:r,...s}=e,i=new AbortController,a=n?setTimeout(()=>i.abort(),n):void 0;return fetch(t,{signal:i.signal,...s}).then(o=>{if(!o.ok)throw new Error("Failed fetch, not 2xx response",{cause:o});switch(r){case"arrayBuffer":return o.arrayBuffer();case"dataUrl":return o.blob().then(tt);case"text":default:return o.text()}}).finally(()=>clearTimeout(a))}function x(e,t){let{url:n,requestType:r="text",responseType:s="text",imageDom:i}=t,a=n,{timeout:o,acceptOfImage:c,requests:h,fetchFn:l,fetch:{requestInit:u,bypassingCache:d,placeholderImage:m},font:g,workers:f,fontFamilies:p}=e;r==="image"&&(P||V)&&e.drawImageCount++;let w=h.get(n);if(!w){d&&d instanceof RegExp&&d.test(a)&&(a+=(/\?/.test(a)?"&":"?")+new Date().getTime());let b=r.startsWith("font")&&g&&g.minify,E=new Set;b&&r.split(";")[1].split(",").forEach(F=>{p.has(F)&&p.get(F).forEach(X=>E.add(X))});let y=b&&E.size,T={url:a,timeout:o,responseType:y?"arrayBuffer":s,headers:r==="image"?{accept:c}:void 0,...u};w={type:r,resolve:void 0,reject:void 0,response:null},w.response=(async()=>{if(l&&r==="image"){let S=await l(n);if(S)return S}return!P&&n.startsWith("http")&&f.length?new Promise((S,F)=>{f[h.size&f.length-1].postMessage({rawUrl:n,...T}),w.resolve=S,w.reject=F}):At(T)})().catch(S=>{if(h.delete(n),r==="image"&&m)return e.log.warn("Failed to fetch image base64, trying to use placeholder image",a),typeof m=="string"?m:m(i);throw S}),h.set(n,w)}return w.response}async function pe(e,t,n,r){if(!we(e))return e;for(let[s,i]of Lt(e,t))try{let a=await x(n,{url:i,requestType:r?"image":"text",responseType:"dataUrl"});e=e.replace(Nt(s),`$1${a}$3`)}catch(a){n.log.warn("Failed to fetch css data url",s,a)}return e}function we(e){return/url\((['"]?)([^'"]+?)\1\)/.test(e)}var Ee=/url\((['"]?)([^'"]+?)\1\)/g;function Lt(e,t){let n=[];return e.replace(Ee,(r,s,i)=>(n.push([i,ce(i,t)]),r)),n.filter(([r])=>!G(r))}function Nt(e){let t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}var It=["background-image","border-image-source","-webkit-border-image","-webkit-mask-image","list-style-image"];function Dt(e,t){return It.map(n=>{let r=e.getPropertyValue(n);return!r||r==="none"?null:((P||V)&&t.drawImageCount++,pe(r,null,t,!0).then(s=>{!s||r===s||e.setProperty(n,s,e.getPropertyPriority(n))}))}).filter(Boolean)}function xt(e,t){if(N(e)){let n=e.currentSrc||e.src;if(!G(n))return[x(t,{url:n,imageDom:e,requestType:"image",responseType:"dataUrl"}).then(r=>{r&&(e.srcset="",e.dataset.originalSrc=n,e.src=r||"")})];(P||V)&&t.drawImageCount++}else if(_(e)&&!G(e.href.baseVal)){let n=e.href.baseVal;return[x(t,{url:n,imageDom:e,requestType:"image",responseType:"dataUrl"}).then(r=>{r&&(e.dataset.originalSrc=n,e.href.baseVal=r||"")})]}return[]}function _t(e,t){let{ownerDocument:n,svgDefsElement:r}=t,s=e.getAttribute("href")??e.getAttribute("xlink:href");if(!s)return[];let[i,a]=s.split("#");if(a){let o=`#${a}`,c=n?.querySelector(`svg ${o}`);if(i&&e.setAttribute("href",o),r?.querySelector(o))return[];if(c)return r?.appendChild(c.cloneNode(!0)),[];if(i)return[x(t,{url:i,responseType:"text"}).then(h=>{r?.insertAdjacentHTML("beforeend",h)})]}return[]}function be(e,t){let{tasks:n}=t;v(e)&&((N(e)||le(e))&&n.push(...xt(e,t)),Ue(e)&&n.push(..._t(e,t))),I(e)&&n.push(...Dt(e.style,t)),e.childNodes.forEach(r=>{be(r,t)})}async function Mt(e,t){let{ownerDocument:n,svgStyleElement:r,fontFamilies:s,fontCssTexts:i,tasks:a,font:o}=t;if(!(!n||!r||!s.size))if(o&&o.cssText){let c=te(o.cssText,t);r.appendChild(n.createTextNode(`${c}
`))}else{let c=Array.from(n.styleSheets).filter(l=>{try{return"cssRules"in l&&!!l.cssRules.length}catch(u){return t.log.warn(`Error while reading CSS rules from ${l.href}`,u),!1}});await Promise.all(c.flatMap(l=>Array.from(l.cssRules).map(async(u,d)=>{if(ke(u)){let m=d+1,g=u.href,f="";try{f=await x(t,{url:g,requestType:"text",responseType:"text"})}catch(w){t.log.warn(`Error fetch remote css import from ${g}`,w)}let p=f.replace(Ee,(w,b,E)=>w.replace(E,ce(E,g)));for(let w of Rt(p))try{l.insertRule(w,w.startsWith("@import")?m+=1:l.cssRules.length)}catch(b){t.log.warn("Error inserting rule from remote css import",{rule:w,error:b})}}}))),c.flatMap(l=>Array.from(l.cssRules)).filter(l=>Oe(l)&&we(l.style.getPropertyValue("src"))&&de(l.style.getPropertyValue("font-family"))?.some(u=>s.has(u))).forEach(l=>{let u=l,d=i.get(u.cssText);d?r.appendChild(n.createTextNode(`${d}
`)):a.push(pe(u.cssText,u.parentStyleSheet?u.parentStyleSheet.href:null,t).then(m=>{m=te(m,t),i.set(u.cssText,m),r.appendChild(n.createTextNode(`${m}
`))}))})}}var Ht=/(\/\*[\s\S]*?\*\/)/g,ee=/((@.*?keyframes [\s\S]*?){([\s\S]*?}\s*?)})/gi;function Rt(e){if(e==null)return[];let t=[],n=e.replace(Ht,"");for(;;){let i=ee.exec(n);if(!i)break;t.push(i[0])}n=n.replace(ee,"");let r=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,s=new RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");for(;;){let i=r.exec(n);if(i)s.lastIndex=r.lastIndex;else if(i=s.exec(n),i)r.lastIndex=s.lastIndex;else break;t.push(i[0])}return t}var Ft=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,Pt=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function te(e,t){let{font:n}=t,r=n?n?.preferredFormat:void 0;return r?e.replace(Pt,s=>{for(;;){let[i,,a]=Ft.exec(s)||[];if(!a)return"";if(a===r)return`src: ${i};`}}):e}async function Ot(e,t){let n=await B(e,t);if(v(n.node)&&_(n.node))return n.node;let{ownerDocument:r,log:s,tasks:i,svgStyleElement:a,svgDefsElement:o,svgStyles:c,font:h,progress:l,autoDestruct:u,onCloneNode:d,onEmbedNode:m,onCreateForeignObjectSvg:g}=n;s.time("clone node");let f=await z(n.node,n,!0);if(a&&r){let y="";c.forEach((T,S)=>{y+=`${T.join(`,
`)} {
  ${S}
}
`}),a.appendChild(r.createTextNode(y))}s.timeEnd("clone node"),await d?.(f),h!==!1&&v(f)&&(s.time("embed web font"),await Mt(f,n),s.timeEnd("embed web font")),s.time("embed node"),be(f,n);let p=i.length,w=0,b=async()=>{for(;;){let y=i.pop();if(!y)break;try{await y}catch(T){n.log.warn("Failed to run task",T)}l?.(++w,p)}};l?.(w,p),await Promise.all([...Array.from({length:4})].map(b)),s.timeEnd("embed node"),await m?.(f);let E=kt(f,n);return o&&E.insertBefore(o,E.children[0]),a&&E.insertBefore(a,E.children[0]),u&&Ct(n),await g?.(E),E}function kt(e,t){let{width:n,height:r}=t,s=Qe(n,r,e.ownerDocument),i=s.ownerDocument.createElementNS(s.namespaceURI,"foreignObject");return i.setAttributeNS(null,"x","0%"),i.setAttributeNS(null,"y","0%"),i.setAttributeNS(null,"width","100%"),i.setAttributeNS(null,"height","100%"),i.append(e),s.appendChild(i),s}async function Ut(e,t){let n=await B(e,t),r=await Ot(n),s=Ze(r,n.isEnable("removeControlCharacter"));n.autoDestruct||(n.svgStyleElement=he(n.ownerDocument),n.svgDefsElement=n.ownerDocument?.createElementNS(U,"defs"),n.svgStyles.clear());let i=L(s,r.ownerDocument);return await at(i,n)}async function Bt(e,t){let n=await B(e,t),{log:r,quality:s,type:i,dpi:a}=n,o=await Ut(n);r.time("canvas to data url");let c=o.toDataURL(i,s);if(["image/png","image/jpeg"].includes(i)&&a&&Re&&Fe){let[h,l]=c.split(","),u=0,d=!1;if(i==="image/png"){let E=Me(l);E>=0?(u=Math.ceil((E+28)/3)*4,d=!0):u=33/3*4}else i==="image/jpeg"&&(u=18/3*4);let m=l.substring(0,u),g=l.substring(u),f=window.atob(m),p=new Uint8Array(f.length);for(let E=0;E<p.length;E++)p[E]=f.charCodeAt(E);let w=i==="image/png"?Ie(p,a,d):Ce(p,a),b=window.btoa(String.fromCharCode(...w));c=[h,",",b,g].join("")}return r.timeEnd("canvas to data url"),c}async function ye(e,t){return Bt(await B(e,{...t,type:"image/png"}))}var A={HIGHLIGHT_COLOR:"#0079F2",HIGHLIGHT_BG:"#0079F210",ALLOWED_DOMAIN:".replit.dev"},M={highlighter:{position:"absolute",zIndex:Number.MAX_SAFE_INTEGER-3,boxSizing:"border-box",pointerEvents:"none",border:`2px solid ${A.HIGHLIGHT_COLOR}`,borderRadius:"4px",background:A.HIGHLIGHT_BG,transition:"opacity 0.2s",willChange:"opacity",opacity:"0"},label:{position:"absolute",backgroundColor:A.HIGHLIGHT_COLOR,color:"#FFFFFF",padding:"2px 6px",borderRadius:"4px",fontSize:"12px",fontFamily:"monospace",transform:"translateY(-100%)",marginTop:"-4px",zIndex:Number.MAX_SAFE_INTEGER-2,pointerEvents:"none",opacity:"0"}};var H={METADATA:"data-replit-metadata",COMPONENT_NAME:"data-component-name"};function ve(e){if(e.startsWith("http://localhost:"))return!0;try{return new URL(e).hostname.endsWith(A.ALLOWED_DOMAIN)}catch{return!1}}function Se(e){return e?document.elementFromPoint(e.clientX,e.clientY):null}function q(e){return!!(e.getAttribute(H.METADATA)&&e.getAttribute(H.COMPONENT_NAME))}function $(e){let t={elementPath:e.getAttribute(H.METADATA)??"",elementName:e.getAttribute(H.COMPONENT_NAME)??"",textContent:e.textContent??"",tag:e.tagName.toLowerCase()};return t.textContent.length>100&&(t.textContent=t.textContent.slice(0,100)+"..."),t}var R=class{selectedElement=null;isActive=!1;lastHighlightedElement=null;hoverHighlighter=null;hoverLabel=null;selectedHighlighter=null;selectedLabel=null;constructor(){this.setupMessageListener(),this.notifyScriptLoaded()}initializeHighlighter(){this.hoverHighlighter=document.createElement("div"),this.hoverLabel=document.createElement("div"),Object.assign(this.hoverHighlighter.style,{...M.highlighter,zIndex:Number.MAX_SAFE_INTEGER,pointerEvents:"all"}),Object.assign(this.hoverLabel.style,{...M.label,zIndex:Number.MAX_SAFE_INTEGER,pointerEvents:"all"}),this.selectedHighlighter=document.createElement("div"),this.selectedLabel=document.createElement("div"),Object.assign(this.selectedHighlighter.style,{...M.highlighter,pointerEvents:"none"}),Object.assign(this.selectedLabel.style,{...M.label,pointerEvents:"none"}),document.body.appendChild(this.selectedHighlighter),document.body.appendChild(this.selectedLabel),document.body.appendChild(this.hoverHighlighter),document.body.appendChild(this.hoverLabel)}setupMessageListener(){window.addEventListener("message",this.handleMessage.bind(this))}notifyScriptLoaded(){this.postMessageToParent({type:"SELECTOR_SCRIPT_LOADED",timestamp:Date.now()})}postMessageToParent(t){window.parent&&window.parent.postMessage(t,"*")}handleMouseMove=t=>{if(this.isActive&&this.hoverHighlighter){this.hoverHighlighter.style.pointerEvents="none";let n=Se(t);if(!n||n===this.hoverHighlighter||n===this.selectedHighlighter||!q(n)){this.hideHighlight(this.hoverHighlighter,this.hoverLabel),this.lastHighlightedElement=null;return}this.lastHighlightedElement=n,this.hoverHighlighter.style.pointerEvents="all",this.hoverHighlighter.style.border=`2px dashed ${A.HIGHLIGHT_COLOR}`,this.updateHighlighterPosition(n,this.hoverHighlighter,this.hoverLabel)}};handleMouseLeave=()=>{this.isActive&&this.hideHighlight(this.hoverHighlighter,this.hoverLabel)};calculateLabelPosition(t,n){return n<24?{top:`${n+window.scrollY}px`,left:`${t.left+window.scrollX}px`,transform:"none",marginTop:"2px"}:{top:`${n+window.scrollY}px`,left:`${t.left+window.scrollX}px`,transform:"translateY(-100%)",marginTop:"-4px"}}updateHighlighterPosition(t,n,r){if(!n||!r)return;let s=t.getBoundingClientRect(),i=window.innerHeight,a=Math.max(0,s.top),o=Math.min(i,s.bottom),c=Math.max(0,o-a);Object.assign(n.style,{opacity:c>0?"1":"0",top:`${a+window.scrollY}px`,left:`${s.left+window.scrollX}px`,width:`${s.width}px`,height:`${c}px`});let h=$(t);r.textContent=h.elementName,Object.assign(r.style,{...this.calculateLabelPosition(s,a),opacity:c>0?"1":"0"})}hideHighlight(t,n){t&&(t.style.opacity="0"),n&&(n.style.opacity="0")}handleClick=async t=>{if(!this.isActive)return;t.preventDefault(),t.stopPropagation();let n=this.lastHighlightedElement;if(!n||!q(n))return;if(n===this.selectedElement){this.unselectCurrentElement(),this.hideHighlight(this.selectedHighlighter,this.selectedLabel),this.postMessageToParent({type:"ELEMENT_UNSELECTED",timestamp:Date.now()});return}this.selectedElement=n,this.selectedHighlighter&&this.selectedLabel&&(this.selectedHighlighter.style.border=`2px solid ${A.HIGHLIGHT_COLOR}`,this.selectedHighlighter.style.opacity="1",this.selectedLabel.style.opacity="1",this.selectedLabel.textContent=$(n).elementName),this.updateHighlighterPosition(n,this.selectedHighlighter,this.selectedLabel);let r;try{r=await ye(n)}catch(i){console.error("Failed to take screenshot:",i)}let s=$(n);this.postMessageToParent({type:"ELEMENT_SELECTED",payload:{...s,screenshotBlob:r},timestamp:Date.now()})};unselectCurrentElement(){this.selectedElement&&(this.selectedElement=null)}handleMessage=t=>{if(!ve(t.origin))return;let n=t.data;if(!(!n||typeof n!="object"))switch(n.type){case"TOGGLE_REPLIT_VISUAL_EDITOR":{this.handleVisualEditorToggle(n.enabled);break}case"CLEAR_SELECTION":{this.unselectCurrentElement(),this.hideHighlight(this.selectedHighlighter,this.selectedLabel);break}}};handleVisualEditorToggle(t){let n=!!t;n?this.postMessageToParent({type:"REPLIT_VISUAL_EDITOR_ENABLED",timestamp:Date.now()}):this.postMessageToParent({type:"REPLIT_VISUAL_EDITOR_DISABLED",timestamp:Date.now()}),this.isActive!==n&&(this.isActive=n,this.toggleEventListeners(n))}recalculateSelectedElement=()=>{this.isActive&&(this.selectedElement&&this.updateHighlighterPosition(this.selectedElement,this.selectedHighlighter,this.selectedLabel),this.lastHighlightedElement&&this.updateHighlighterPosition(this.lastHighlightedElement,this.hoverHighlighter,this.hoverLabel))};toggleEventListeners(t){t?(this.initializeHighlighter(),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseleave",this.handleMouseLeave),document.addEventListener("click",this.handleClick,!0),window.addEventListener("resize",this.recalculateSelectedElement),window.addEventListener("scroll",this.recalculateSelectedElement,!0),document.body.style.cursor="pointer"):(document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("click",this.handleClick,!0),document.removeEventListener("mouseleave",this.handleMouseLeave),window.removeEventListener("resize",this.recalculateSelectedElement),window.removeEventListener("scroll",this.recalculateSelectedElement,!0),this.hoverHighlighter?.remove(),this.hoverLabel?.remove(),this.selectedHighlighter?.remove(),this.selectedLabel?.remove(),this.hoverHighlighter=null,this.hoverLabel=null,this.selectedHighlighter=null,this.selectedLabel=null,document.body.style.cursor="",this.selectedElement=null)}};if(typeof window<"u")try{window.REPLIT_BEACON_VERSION||(window.REPLIT_BEACON_VERSION=Y,new R)}catch(e){console.error("[replit-beacon] Failed to initialize:",e)}})();
